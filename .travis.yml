language: java

jdk:
  - openjdk15

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: jde5IDMj/X2RXasZ/6iGlDXZgaJU10uAgsas8G/pEh+fdL22Tg2NeE0/wv1vLAqeBAJ3sztpv3YD04w6+H9DlRVQeO3wbDriMh2rKTqpiaoDVyzhBQklQsVZRM8L9vd1hDT+ADn70v7+Kc4vZk9iz6mUhwLdwnASBiTKuWSUxzQcVtOuGu+7D6LOrAqrtAfDVxd73pOOIpbpQtUmKLywLDcSHSq1XNbRTi5oIHfqZOn4SISZNselnGq4xXJjUl1/IQ4P8GIbp8yzC3pZdxyHi6MoBgCTHMwqxgmBSTN2MgKQlamXUSeClrG2km7+66lnor1EDnWNxK6dg1MwSHp0N5qXQ1ovcHC7Bf9BuA1oMVn5uNEzZBtTUsLmGij7w05wfCs1eNH2Jhkt+mEkgzSknhcgxnAORNC/vVq2LeEaCwRcJwMX7fpPkddk3xkFfWL63yrl15Ycy7oYwE5Iz98CwQMxAMcyiDoZaMVlu1eED9Ljb6lt2Ir9RyVu8AI72Yrp0NJIUyvmZCOBDdNQM6DTvAwtdilGYDbtpHaXEQqdN8jqDyd6Fg4luKau0dfiqK9XXelDzpei3PtUPocNSYYbJ4yW7kRJEw33vMzCmchcClcj9d6G66k/ZbsMMgO6+ZdFRHCLZzD8E2Ai1iNdYqxxigkGwOBbi2qCtscd88TBpWs=
  file: "target/spt-development-cid-web-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true