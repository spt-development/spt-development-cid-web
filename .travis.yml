language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: cYEK90wFMEVE5fcjRV7P6iiQ6IpGCgQpNnA4jJzvdbluloQPY1HiddozUw+FULJKgyAwIGEpXC3R1BIG4rqIzWhnhaGodn5nqAqOjbD7JksUiRTNsWmwUB85qVA6wMZ/FcDL4onv1uw0iBZ5OIMpqoGEw6916j5/SUJjOcaO8QV9HkiHorNFMTWJuWRR7+ltc5HH6FDbPCiR+urnirCBSZlVzjxoU6adgpuRL8TBWt2aaivZhHgMX7h92uQlNav8XwvQUaECF9/rRuAna8IgRtk/ICA7vkOyIyF7yVXJ31zHx7ZsB/Hd3HE33v/W6hyruKiG+NhlqGAJ0POP0T3sh6cFI1iaTJm8I0bEc5l76KDZpzvFYsALpmQ/mvu9xjBpVW9xhG+uWzQDXhPCfutxJsVRqs47PLCmAMIEdi89QXMxwv0JuafF2EUMDKexrqfp/KUOKzF0R4b4I8eXRWK8CaNBxpXAhix5AntsYc9TJ9zg47kc0aILznOio35t9jwbwr8JO+aimSKbJ/la1Z+LiBIvk120OA1fbX+JDaYcAncxGb+zyb6LbunhwFoOCLDPlhzTp32jMvQs9hNiaHX61WNKLcDINtAAdomUlMUacdmPWauVFLnnbWZ2uF/W2+Or68KUU04jNe2QSFII2ngmh8Jn9zDrehSYznQHoq/c240=
  file: "target/spt-development-cid-web-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true